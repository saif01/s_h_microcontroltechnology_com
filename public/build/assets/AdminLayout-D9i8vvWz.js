import{_ as N,d as U,a as t,w as r,b as a,c as l,i as m,r as o,m as g,f as p,j as E,t as h,u as z,g as j,o as n}from"./app-JEOr28RX.js";import{h as T}from"./moment-C5S46NFB.js";const F={data(){return{drawer:!0,currentUser:null,userRoles:[],userPermissions:[],currentDate:T().format("Do MMMM YYYY"),currentYear:new Date().getFullYear()}},methods:{async loadUser(){var d;try{const e=localStorage.getItem("admin_token");if(!e){this.$router.push("/admin/login");return}const _=await j.get("/api/v1/auth/user",{headers:{Authorization:`Bearer ${e}`}});this.currentUser=_.data,this.userRoles=_.data.roles||[],this.userPermissions=[],this.userRoles&&this.userRoles.length>0&&this.userRoles.forEach(v=>{v.permissions&&v.permissions.length>0&&v.permissions.forEach(s=>{this.userPermissions.includes(s.slug)||this.userPermissions.push(s.slug)})})}catch(e){console.error("Error loading user:",e),((d=e.response)==null?void 0:d.status)===401&&(localStorage.removeItem("admin_token"),this.$router.push("/admin/login"))}},async logout(){await z().logout(),this.currentUser=null,this.userRoles=[],this.userPermissions=[],this.$router.push("/admin/login")},hasPermission(d){return this.currentUser&&(this.currentUser.role==="admin"||this.userRoles&&this.userRoles.some(e=>e.slug==="administrator"))?!0:this.userPermissions.includes(d)}},mounted(){localStorage.getItem("admin_token")?this.loadUser():this.$router.push("/admin/login")}},q={class:"pa-2"},G={key:1,class:"d-flex align-center mr-4"},H={class:"footer-content"},J={class:"footer-info"},K={class:"copyright-text"};function O(d,e,_,v,s,u){const i=o("v-list-item"),x=o("v-divider"),f=o("v-list-group"),k=o("v-list"),R=o("v-icon"),A=o("v-btn"),L=o("v-navigation-drawer"),S=o("v-app-bar-nav-icon"),P=o("v-chip"),y=o("v-spacer"),w=o("v-img"),V=o("v-avatar"),b=o("v-list-item-title"),D=o("v-menu"),B=o("v-app-bar"),C=o("router-view"),Y=o("v-container"),I=o("v-main"),M=o("v-footer");return n(),U("div",null,[t(L,{modelValue:s.drawer,"onUpdate:modelValue":e[1]||(e[1]=c=>s.drawer=c),class:"gradient_color",location:"left",permanent:"","hide-overlay":"",app:"",dark:""},{append:r(()=>[a("div",q,[t(A,{link:"",router:"",onClick:e[0]||(e[0]=c=>u.logout()),class:"logout-btn text-black",size:"small",block:""},{default:r(()=>[t(R,{left:""},{default:r(()=>e[4]||(e[4]=[p("mdi-logout")])),_:1,__:[4]}),e[5]||(e[5]=p("Logout "))]),_:1,__:[5]})])]),default:r(()=>[e[6]||(e[6]=a("div",{class:"sidebar-shapes"},[a("div",{class:"shape shape-1"}),a("div",{class:"shape shape-2"}),a("div",{class:"shape shape-3"})],-1)),s.currentUser?(n(),l(i,{key:0,class:"user-profile-header","prepend-avatar":s.currentUser.avatar||"/assets/logo/logo.png",title:s.currentUser.name||"Admin Panel",subtitle:s.userRoles&&s.userRoles.length>0?s.userRoles.map(c=>c.name).join(", "):"No roles assigned"},null,8,["prepend-avatar","title","subtitle"])):m("",!0),t(x,{class:"my-0 divider-glow"}),t(k,{density:"compact",nav:""},{default:r(()=>[u.hasPermission("access-dashboard")?(n(),l(i,{key:0,link:"",router:"","prepend-icon":"mdi-view-dashboard",title:"Dashboard",to:{name:"AdminDashboard"},value:"Dashboard",exact:""})):m("",!0),u.hasPermission("manage-pages")?(n(),l(i,{key:1,link:"",router:"","prepend-icon":"mdi-file-document",title:"Pages",to:{name:"AdminPages"},value:"Pages",exact:""})):m("",!0),u.hasPermission("manage-services")?(n(),l(i,{key:2,link:"",router:"","prepend-icon":"mdi-wrench",title:"Services",to:{name:"AdminServices"},value:"Services",exact:""})):m("",!0),u.hasPermission("manage-products")?(n(),l(i,{key:3,link:"",router:"","prepend-icon":"mdi-package-variant",title:"Products",to:{name:"AdminProducts"},value:"Products",exact:""})):m("",!0),u.hasPermission("view-leads")?(n(),l(i,{key:4,link:"",router:"","prepend-icon":"mdi-email",title:"Leads",to:{name:"AdminLeads"},value:"Leads",exact:""})):m("",!0),u.hasPermission("manage-users")?(n(),l(i,{key:5,link:"",router:"","prepend-icon":"mdi-account-group",title:"Users",to:{name:"AdminUsers"},value:"Users",exact:""})):m("",!0),u.hasPermission("manage-roles")?(n(),l(f,{key:6,value:"roles","prepend-icon":"mdi-shield-account","no-action":""},{activator:r(({props:c})=>[t(i,g(c,{title:"Roles & Permissions"}),null,16)]),default:r(()=>[t(i,{"prepend-icon":"mdi-shield-account",title:"Roles",to:{name:"AdminRoles"}}),t(i,{"prepend-icon":"mdi-key",title:"Permissions",to:{name:"AdminPermissions"}})]),_:1})):m("",!0),u.hasPermission("manage-settings")?(n(),l(i,{key:7,link:"",router:"","prepend-icon":"mdi-cog",title:"Settings",to:{name:"AdminSettings"},value:"Settings",exact:""})):m("",!0),u.hasPermission("view-login-logs")||u.hasPermission("view-visitor-logs")?(n(),l(f,{key:8,value:"logs","prepend-icon":"mdi-file-document-multiple","no-action":""},{activator:r(({props:c})=>[t(i,g(c,{title:"Logs"}),null,16)]),default:r(()=>[u.hasPermission("view-login-logs")?(n(),l(i,{key:0,"prepend-icon":"mdi-login",title:"Login Logs",to:{name:"AdminLoginLogs"}})):m("",!0),u.hasPermission("view-visitor-logs")?(n(),l(i,{key:1,"prepend-icon":"mdi-account-group",title:"Visitor Logs",to:{name:"AdminVisitorLogs"}})):m("",!0)]),_:1})):m("",!0)]),_:1})]),_:1,__:[6]},8,["modelValue"]),t(B,{app:"",flat:"",density:"compact",class:"gradient_color app-bar-modern"},{default:r(()=>[t(S,{onClick:e[2]||(e[2]=E(c=>s.drawer=!s.drawer,["stop"]))}),t(P,{class:"mx-2 date-chip"},{default:r(()=>[p(h(s.currentDate),1)]),_:1}),t(y),s.currentUser&&(s.currentUser.role==="admin"||s.userRoles&&s.userRoles.some(c=>c.slug==="administrator"))?(n(),l(P,{key:0,"prepend-icon":"mdi-shield-account"},{default:r(()=>e[7]||(e[7]=[p("Administrator")])),_:1,__:[7]})):m("",!0),t(y),s.currentUser?(n(),U("div",G,[t(D,{"open-on-hover":""},{activator:r(({props:c})=>[t(V,g(c,{size:"42",class:"fill-image mr-2",title:s.currentUser.name}),{default:r(()=>[s.currentUser.avatar?(n(),l(w,{key:0,cover:"",src:s.currentUser.avatar,alt:s.currentUser.name},null,8,["src","alt"])):(n(),l(w,{key:1,cover:"",src:"/assets/logo/logo.png",alt:"image"}))]),_:2},1040,["title"])]),default:r(()=>[t(k,null,{default:r(()=>[t(i,null,{default:r(()=>[t(b,null,{default:r(()=>[p(h(s.currentUser.name),1)]),_:1})]),_:1}),t(i,{link:"",router:"",onClick:e[3]||(e[3]=c=>u.logout())},{default:r(()=>[t(b,null,{default:r(()=>e[8]||(e[8]=[p("Logout")])),_:1,__:[8]})]),_:1})]),_:1})]),_:1})])):m("",!0)]),_:1}),t(I,null,{default:r(()=>[t(Y,{fluid:""},{default:r(()=>[t(C)]),_:1})]),_:1}),t(M,{class:"footer-modern gradient_color rtl-footer",app:""},{default:r(()=>[a("div",H,[e[10]||(e[10]=a("div",{class:"footer-brand"},[a("div",{class:"logo-wrapper"},[a("img",{src:"/assets/logo/logo.png",alt:"cpb-it",height:"24",class:"footer-logo"})]),a("div",{class:"brand-text"},[a("span",{class:"brand-name"},"Powered By CPB-IT")])],-1)),e[11]||(e[11]=a("div",{class:"footer-divider"},null,-1)),a("div",J,[e[9]||(e[9]=a("span",{class:"version-badge"},"v2.0",-1)),a("span",K,"Â© "+h(s.currentYear)+" All Rights Reserved",1)])])]),_:1})])}const X=N(F,[["render",O],["__scopeId","data-v-2a2af6ce"]]);export{X as default};
