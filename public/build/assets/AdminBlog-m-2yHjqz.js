import{_ as M,d as h,a as o,o as g,g as y,c as w,w as s,b as l,r,t as c,f as p,h as v,n as B,F as A,e as O}from"./app-e4gunLXV.js";import{a as q}from"./adminPaginationMixin-DN7Wb3ng.js";import{r as J,n as X}from"./uploads-CnEkgyD_.js";import{Q as Y}from"./quill.snow-C9-Cfp6g.js";const Z={name:"RichTextEditor",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Enter content..."},disabled:{type:Boolean,default:!1},active:{type:Boolean,default:!0}},emits:["update:modelValue"],data(){return{quillEditor:null,isInitialized:!1}},watch:{modelValue(t){this.quillEditor&&this.quillEditor.root.innerHTML!==t&&this.quillEditor.clipboard.dangerouslyPasteHTML(t||"")},active(t,e){t&&!e?this.isInitialized||this.$nextTick(()=>{this.initEditor()}):!t&&e&&this.destroyEditor()},disabled(t){this.quillEditor&&this.quillEditor.enable(!t)}},mounted(){this.active&&this.$nextTick(()=>{this.initEditor()})},beforeUnmount(){this.destroyEditor()},methods:{initEditor(){if(this.isInitialized||this.quillEditor)return;const t=this.$refs.editorContainer;if(t){this.cleanupQuillDom();try{t.innerHTML="",this.quillEditor=new Y(t,{theme:"snow",modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image"],["blockquote","code-block"],["clean"]]},placeholder:this.placeholder,readOnly:this.disabled}),this.modelValue?this.quillEditor.clipboard.dangerouslyPasteHTML(this.modelValue):this.quillEditor.setText(""),this.quillEditor.on("text-change",()=>{const e=this.quillEditor.root.innerHTML;this.$emit("update:modelValue",e)}),this.isInitialized=!0}catch(e){console.error("Error initializing Quill editor:",e),this.quillEditor=null,this.isInitialized=!1}}},destroyEditor(){this.quillEditor&&(this.quillEditor=null),this.cleanupQuillDom(),this.isInitialized=!1},cleanupQuillDom(){const t=this.$refs.editorContainer,e=this.$refs.editorWrapper||(t?t.parentElement:null);e&&e.querySelectorAll(".ql-toolbar").forEach(m=>m.remove()),t&&(t.innerHTML="",t.className="rich-text-editor")},getContent(){return this.quillEditor?this.quillEditor.root.innerHTML:this.modelValue},setContent(t){this.quillEditor&&(this.quillEditor.root.innerHTML=t||"",this.$emit("update:modelValue",t||""))},focus(){this.quillEditor&&this.quillEditor.focus()}}},$={ref:"editorWrapper",class:"rich-text-editor-wrapper"},ee={ref:"editorContainer",class:"rich-text-editor"};function te(t,e,u,m,i,a){return g(),h("div",$,[o("div",ee,null,512)],512)}const ie=M(Z,[["render",te],["__scopeId","data-v-b58509aa"]]),le={name:"BlogFormDialog",components:{RichTextEditor:ie},mixins:[q],props:{modelValue:{type:Boolean,default:!1},editingPost:{type:Object,default:null}},emits:["update:modelValue","saved"],data(){return{activeTab:"basic",loading:!1,saving:!1,imageFile:null,imagePreview:null,uploadingImage:!1,imageError:null,ogImageFile:null,ogImagePreview:null,uploadingOgImage:!1,ogImageError:null,availableCategories:[],availableTags:[],loadingCategories:!1,form:{title:"",slug:"",excerpt:"",content:"",featured_image:"",published_at:"",meta_title:"",meta_description:"",meta_keywords:"",og_image:"",published:!1,category_ids:[],tag_names:[]}}},computed:{dialog:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},watch:{modelValue(t){t&&(this.activeTab="basic",this.loadCategories(),this.loadTags(),this.editingPost?this.loadPostForEdit():this.resetForm())},editingPost:{handler(t){t&&this.dialog?this.loadPostForEdit():!t&&this.dialog&&this.resetForm()},immediate:!1}},methods:{resetForm(){this.form={title:"",slug:"",excerpt:"",content:"",featured_image:"",published_at:"",meta_title:"",meta_description:"",meta_keywords:"",og_image:"",published:!1,category_ids:[],tag_names:[]},this.imageFile=null,this.imagePreview=null,this.imageError=null,this.ogImageFile=null,this.ogImagePreview=null,this.ogImageError=null,this.$refs.formRef&&this.$refs.formRef.resetValidation()},async loadPostForEdit(){if(this.editingPost){this.loading=!0;try{const e=(await y.get(`/api/v1/blog-posts/${this.editingPost.id}`,{headers:this.getAuthHeaders()})).data;let u="";e.published_at&&(u=new Date(e.published_at).toISOString().slice(0,16)),this.form={title:e.title||"",slug:e.slug||"",excerpt:e.excerpt||"",content:e.content||"",featured_image:e.featured_image||"",published_at:u,meta_title:e.meta_title||"",meta_description:e.meta_description||"",meta_keywords:e.meta_keywords||"",og_image:e.og_image||"",published:e.published||!1,category_ids:(e.categories||[]).map(m=>m.id),tag_names:(e.tags||[]).map(m=>m.name||m)},this.imagePreview=this.resolveImageUrl(e.featured_image||""),this.ogImagePreview=this.resolveImageUrl(e.og_image||"")}catch(t){this.handleApiError(t,"Failed to load post data"),this.closeDialog()}finally{this.loading=!1}}},async loadCategories(){var t;try{this.loadingCategories=!0;const e=await y.get("/api/v1/blog-categories",{headers:this.getAuthHeaders()}).catch(()=>null);if(e&&e.data){const u=((t=e.data)==null?void 0:t.data)||e.data||[];this.availableCategories=Array.isArray(u)?u:[]}else this.availableCategories=[]}catch(e){console.error("Error loading blog categories:",e),this.availableCategories=[]}finally{this.loadingCategories=!1}},async loadTags(){var t;try{const e=await y.get("/api/v1/tags?type=post",{headers:this.getAuthHeaders()}).catch(()=>null);if(e||(e=await y.get("/api/v1/tags",{headers:this.getAuthHeaders()}).catch(()=>null)),e&&e.data){const u=((t=e.data)==null?void 0:t.data)||e.data||[],m=Array.isArray(u)?u.filter(i=>!i.type||i.type==="post"):[];this.availableTags=m.map(i=>i.name||i)}else this.availableTags=[]}catch(e){console.error("Error loading tags:",e),this.availableTags=[]}},closeDialog(){!this.saving&&!this.loading&&(this.dialog=!1,this.resetForm())},generateSlug(){this.form.title&&!this.editingPost&&(this.form.slug=this.form.title.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},handleImageSelect(t){if(this.imageError=null,t){const e=Array.isArray(t)?t[0]:t;if(e&&e.size>5242880){this.imageError="Image file size must be less than 5MB",this.imageFile=null;return}if(e&&!e.type.startsWith("image/")){this.imageError="Please select a valid image file",this.imageFile=null;return}if(this.imageFile=e,e){const u=new FileReader;u.onload=m=>{this.imagePreview=m.target.result},u.readAsDataURL(e)}else this.imagePreview=null}else this.imageFile=null,this.form.featured_image?this.imagePreview=this.resolveImageUrl(this.form.featured_image):this.imagePreview=null},removeImage(){confirm("Are you sure you want to remove this image?")&&(this.imagePreview=null,this.imageFile=null,this.form.featured_image="",this.imageError=null)},handleOgImageSelect(t){if(this.ogImageError=null,t){const e=Array.isArray(t)?t[0]:t;if(e&&e.size>5242880){this.ogImageError="OG image file size must be less than 5MB",this.ogImageFile=null;return}if(e&&!e.type.startsWith("image/")){this.ogImageError="Please select a valid image file",this.ogImageFile=null;return}if(this.ogImageFile=e,e){const u=new FileReader;u.onload=m=>{this.ogImagePreview=m.target.result},u.readAsDataURL(e)}else this.ogImagePreview=null}else this.ogImageFile=null,this.form.og_image?this.ogImagePreview=this.resolveImageUrl(this.form.og_image):this.ogImagePreview=null},removeOgImage(){confirm("Are you sure you want to remove the Open Graph image?")&&(this.ogImagePreview=null,this.ogImageFile=null,this.form.og_image="",this.ogImageError=null)},generateMetaTitle(){this.form.title&&(this.form.meta_title=this.form.title.length>60?this.form.title.substring(0,57)+"...":this.form.title)},generateMetaDescription(){if(this.form.excerpt){let t=this.form.excerpt;if(t.length>160){t=t.substring(0,157);const e=t.lastIndexOf(" ");e>120?t=t.substring(0,e)+"...":t+="..."}this.form.meta_description=t}},getMetaTitleColor(){const t=this.form.meta_title?this.form.meta_title.length:0;return t===0?"primary":t<50?"warning":t>60?"error":"success"},getMetaDescriptionColor(){const t=this.form.meta_description?this.form.meta_description.length:0;return t===0?"primary":t<120?"warning":t>160?"error":"success"},async uploadImage(){var e,u;if(!this.imageFile)return null;const t=Array.isArray(this.imageFile)?this.imageFile[0]:this.imageFile;if(!t)return null;this.uploadingImage=!0;try{const m=new FormData;m.append("image",t),m.append("folder","blog"),this.form.title&&m.append("prefix",this.form.title);const i=await y.post("/api/v1/upload/image",m,{headers:{...this.getAuthHeaders(),"Content-Type":"multipart/form-data"}});if(i.data.success){const a=this.normalizeImageInput(i.data.path||i.data.url);return this.form.featured_image=a,this.imagePreview=this.resolveImageUrl(i.data.url||a),this.imageFile=null,this.imageError=null,a}else throw new Error(i.data.message||"Failed to upload image")}catch(m){let i="Failed to upload image";throw(u=(e=m.response)==null?void 0:e.data)!=null&&u.message&&(i=m.response.data.message),this.imageError=i,new Error(i)}finally{this.uploadingImage=!1}},async uploadOgImage(){var e,u;if(!this.ogImageFile)return null;const t=Array.isArray(this.ogImageFile)?this.ogImageFile[0]:this.ogImageFile;if(!t)return null;this.uploadingOgImage=!0;try{const m=new FormData;m.append("image",t),m.append("folder","blog/og"),this.form.title&&m.append("prefix",this.form.title);const i=await y.post("/api/v1/upload/image",m,{headers:{...this.getAuthHeaders(),"Content-Type":"multipart/form-data"}});if(i.data.success){const a=this.normalizeImageInput(i.data.path||i.data.url);return this.form.og_image=a,this.ogImagePreview=this.resolveImageUrl(i.data.url||a),this.ogImageFile=null,this.ogImageError=null,a}else throw new Error(i.data.message||"Failed to upload OG image")}catch(m){let i="Failed to upload OG image";throw(u=(e=m.response)==null?void 0:e.data)!=null&&u.message&&(i=m.response.data.message),this.ogImageError=i,new Error(i)}finally{this.uploadingOgImage=!1}},async savePost(){const{valid:t}=await this.$refs.formRef.validate();if(!t){this.showError("Please fill in all required fields");return}if(!this.form.content||this.form.content.trim()===""||this.form.content==="<p><br></p>"){this.showError("Post content is required");return}this.saving=!0;try{if(this.imageFile)try{await this.uploadImage()}catch(u){this.showError(u.message||"Failed to upload image");return}if(this.ogImageFile)try{await this.uploadOgImage()}catch(u){this.showError(u.message||"Failed to upload OG image");return}const e={title:this.form.title,slug:this.form.slug,excerpt:this.form.excerpt||null,content:this.form.content,featured_image:this.normalizeImageInput(this.form.featured_image)||null,published_at:this.form.published_at||null,meta_title:this.form.meta_title||null,meta_description:this.form.meta_description||null,meta_keywords:this.form.meta_keywords||null,og_image:this.normalizeImageInput(this.form.og_image)||null,published:this.form.published||!1,category_ids:this.form.category_ids||[],tag_names:this.form.tag_names||[]};this.editingPost?(await y.put(`/api/v1/blog-posts/${this.editingPost.id}`,e,{headers:this.getAuthHeaders()}),this.showSuccess("Blog post updated successfully")):(await y.post("/api/v1/blog-posts",e,{headers:this.getAuthHeaders()}),this.showSuccess("Blog post created successfully")),this.$emit("saved"),this.closeDialog()}catch(e){this.handleApiError(e,this.editingPost?"Failed to update post":"Failed to create post")}finally{this.saving=!1}},normalizeImageInput(t){return X(t)},resolveImageUrl(t){return J(t)}}},oe={class:"text-h5 font-weight-bold"},se={key:0,class:"d-flex align-center justify-center pa-12"},ae={class:"text-center"},re={class:"pa-6"},ne={class:"pa-6"},de={class:"d-flex flex-column flex-md-row align-start"},me={key:0,class:"mr-md-4 mb-4 mb-md-0"},ue={class:"mt-2"},ge={class:"flex-grow-1"},pe={class:"text-body-2"},ce={key:2,class:"text-caption text-medium-emphasis mt-2"},he={class:"pa-6"},fe={class:"pa-6"},ve={class:"d-flex flex-column flex-md-row align-start"},_e={key:0,class:"mr-md-4 mb-4 mb-md-0"},be={class:"mt-2"},ye={class:"flex-grow-1"},we={class:"text-body-2"};function Pe(t,e,u,m,i,a){const _=r("v-btn"),C=r("v-card-title"),I=r("v-progress-circular"),x=r("v-tab"),z=r("v-tabs"),P=r("v-text-field"),f=r("v-col"),S=r("v-textarea"),E=r("v-switch"),b=r("v-row"),V=r("v-window-item"),F=r("v-label"),D=r("RichTextEditor"),T=r("v-img"),U=r("v-file-input"),d=r("v-alert"),k=r("v-card"),H=r("v-select"),R=r("v-combobox"),L=r("v-divider"),N=r("v-window"),G=r("v-form"),Q=r("v-card-text"),j=r("v-spacer"),W=r("v-card-actions"),K=r("v-dialog");return g(),w(K,{modelValue:a.dialog,"onUpdate:modelValue":e[17]||(e[17]=n=>a.dialog=n),"max-width":"1400",scrollable:"",persistent:""},{default:s(()=>[l(k,null,{default:s(()=>[l(C,{class:"d-flex align-center justify-space-between bg-primary text-white pa-4"},{default:s(()=>[o("span",oe,c(u.editingPost?"Edit Blog Post":"Create New Blog Post"),1),l(_,{icon:"mdi-close",variant:"text",color:"white",onClick:a.closeDialog,disabled:i.saving||i.loading},null,8,["onClick","disabled"])]),_:1}),l(Q,{class:"pa-0"},{default:s(()=>[i.loading?(g(),h("div",se,[o("div",ae,[l(I,{indeterminate:"",color:"primary",size:"64"}),e[18]||(e[18]=o("p",{class:"text-body-1 text-medium-emphasis mt-4"},"Loading post data...",-1))])])):(g(),w(G,{key:1,ref:"formRef"},{default:s(()=>[l(z,{modelValue:i.activeTab,"onUpdate:modelValue":e[0]||(e[0]=n=>i.activeTab=n),"bg-color":"grey-lighten-4"},{default:s(()=>[l(x,{value:"basic"},{default:s(()=>e[19]||(e[19]=[p("Basic Information")])),_:1,__:[19]}),l(x,{value:"content"},{default:s(()=>e[20]||(e[20]=[p("Content")])),_:1,__:[20]}),l(x,{value:"categories"},{default:s(()=>e[21]||(e[21]=[p("Categories & Tags")])),_:1,__:[21]}),l(x,{value:"seo"},{default:s(()=>e[22]||(e[22]=[p("SEO & Meta")])),_:1,__:[22]})]),_:1},8,["modelValue"]),l(N,{modelValue:i.activeTab,"onUpdate:modelValue":e[16]||(e[16]=n=>i.activeTab=n)},{default:s(()=>[l(V,{value:"basic"},{default:s(()=>[o("div",re,[l(b,null,{default:s(()=>[l(f,{cols:"12"},{default:s(()=>[l(P,{modelValue:i.form.title,"onUpdate:modelValue":e[1]||(e[1]=n=>i.form.title=n),label:"Post Title *",variant:"outlined",rules:[n=>!!n||"Title is required"],hint:"Enter the blog post title",onBlur:a.generateSlug,"persistent-hint":""},null,8,["modelValue","rules","onBlur"])]),_:1}),l(f,{cols:"12",md:"6"},{default:s(()=>[l(P,{modelValue:i.form.slug,"onUpdate:modelValue":e[2]||(e[2]=n=>i.form.slug=n),label:"Slug *",variant:"outlined",rules:[n=>!!n||"Slug is required",n=>!n||/^[a-z0-9-]+$/.test(n)||"Slug can only contain lowercase letters, numbers, and hyphens"],hint:"URL-friendly version (auto-generated from title)","persistent-hint":""},{append:s(()=>[l(_,{icon:"mdi-refresh",size:"small",variant:"text",onClick:a.generateSlug,disabled:!i.form.title},null,8,["onClick","disabled"])]),_:1},8,["modelValue","rules"])]),_:1}),l(f,{cols:"12",md:"6"},{default:s(()=>[l(P,{modelValue:i.form.published_at,"onUpdate:modelValue":e[3]||(e[3]=n=>i.form.published_at=n),label:"Published Date",type:"datetime-local",variant:"outlined",hint:"When to publish this post","persistent-hint":""},null,8,["modelValue"])]),_:1}),l(f,{cols:"12"},{default:s(()=>[l(S,{modelValue:i.form.excerpt,"onUpdate:modelValue":e[4]||(e[4]=n=>i.form.excerpt=n),label:"Excerpt",variant:"outlined",rows:"3",hint:"Brief summary shown in blog listings","persistent-hint":"",counter:300},null,8,["modelValue"])]),_:1}),l(f,{cols:"12"},{default:s(()=>[l(E,{modelValue:i.form.published,"onUpdate:modelValue":e[5]||(e[5]=n=>i.form.published=n),label:"Published",color:"success",hint:"Publish this post on the public website","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),l(V,{value:"content"},{default:s(()=>[o("div",ne,[l(b,null,{default:s(()=>[l(f,{cols:"12"},{default:s(()=>[l(F,{class:"mb-2"},{default:s(()=>e[23]||(e[23]=[p("Post Content *")])),_:1,__:[23]}),l(D,{modelValue:i.form.content,"onUpdate:modelValue":e[6]||(e[6]=n=>i.form.content=n),active:i.activeTab==="content",placeholder:"Enter blog post content..."},null,8,["modelValue","active"])]),_:1}),l(f,{cols:"12"},{default:s(()=>[l(F,{class:"mb-2"},{default:s(()=>e[24]||(e[24]=[p("Featured Image")])),_:1,__:[24]}),l(k,{variant:"outlined",class:"pa-4"},{default:s(()=>[o("div",de,[i.imagePreview||i.form.featured_image?(g(),h("div",me,[l(T,{src:i.imagePreview||a.resolveImageUrl(i.form.featured_image),"max-width":"300","max-height":"300",class:"rounded elevation-2",cover:""},null,8,["src"]),o("div",ue,[l(_,{color:"error",size:"small",variant:"text",onClick:a.removeImage,"prepend-icon":"mdi-delete"},{default:s(()=>e[25]||(e[25]=[p(" Remove Image ")])),_:1,__:[25]},8,["onClick"])])])):v("",!0),o("div",ge,[l(U,{modelValue:i.imageFile,"onUpdate:modelValue":[e[7]||(e[7]=n=>i.imageFile=n),a.handleImageSelect],accept:"image/*",label:"Select Featured Image",variant:"outlined","prepend-icon":"","prepend-inner-icon":"mdi-image","show-size":"",clearable:"",hint:"Recommended size: 1200x800px or larger. Max file size: 5MB","persistent-hint":""},{append:s(()=>[i.uploadingImage?(g(),w(I,{key:0,indeterminate:"",color:"primary",size:"24"})):v("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"]),i.imageFile&&i.imageFile.size>5242880?(g(),w(d,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mt-2"},{default:s(()=>e[26]||(e[26]=[p(" File size is larger than 5MB. Please choose a smaller image. ")])),_:1,__:[26]})):v("",!0),i.imageError?(g(),w(d,{key:1,type:"error",variant:"tonal",density:"compact",class:"mt-2",closable:"","onClick:close":e[8]||(e[8]=n=>i.imageError=null)},{default:s(()=>[o("div",pe,[e[27]||(e[27]=o("strong",null,"Upload Error:",-1)),p(" "+c(i.imageError),1)])]),_:1})):v("",!0),!i.imagePreview&&!i.imageFile?(g(),h("div",ce," No image selected. Upload an image to display with this post. ")):v("",!0)])])]),_:1})]),_:1})]),_:1})])]),_:1}),l(V,{value:"categories"},{default:s(()=>[o("div",he,[l(b,null,{default:s(()=>[l(f,{cols:"12"},{default:s(()=>[e[28]||(e[28]=o("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Categories",-1)),l(H,{modelValue:i.form.category_ids,"onUpdate:modelValue":e[9]||(e[9]=n=>i.form.category_ids=n),items:i.availableCategories,"item-title":"name","item-value":"id",label:"Select Categories",variant:"outlined",multiple:"",chips:"",loading:i.loadingCategories,hint:"Select categories for this post (type='post')","persistent-hint":""},null,8,["modelValue","items","loading"])]),_:1,__:[28]}),l(f,{cols:"12"},{default:s(()=>[e[29]||(e[29]=o("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Tags",-1)),l(R,{modelValue:i.form.tag_names,"onUpdate:modelValue":e[10]||(e[10]=n=>i.form.tag_names=n),items:i.availableTags,label:"Tags",variant:"outlined",multiple:"",chips:"","closable-chips":"",hint:"Type to add new tags (type='post')","persistent-hint":""},null,8,["modelValue","items"])]),_:1,__:[29]})]),_:1})])]),_:1}),l(V,{value:"seo"},{default:s(()=>[o("div",fe,[l(d,{type:"info",variant:"tonal",class:"mb-6",density:"compact"},{default:s(()=>e[30]||(e[30]=[o("div",{class:"text-body-2"},[o("strong",null,"SEO Best Practices:"),p(" Fill in these fields to improve your post visibility in search engines and social media. ")],-1)])),_:1,__:[30]}),l(b,null,{default:s(()=>[l(f,{cols:"12"},{default:s(()=>[l(P,{modelValue:i.form.meta_title,"onUpdate:modelValue":e[11]||(e[11]=n=>i.form.meta_title=n),label:"Meta Title",variant:"outlined",hint:"SEO title for search engines (recommended: 50-60 characters)","persistent-hint":"",counter:60,color:a.getMetaTitleColor(),"prepend-inner-icon":"mdi-format-title"},{append:s(()=>[l(_,{icon:"mdi-refresh",size:"small",variant:"text",onClick:a.generateMetaTitle,disabled:!i.form.title,title:"Auto-generate from post title"},null,8,["onClick","disabled"])]),_:1},8,["modelValue","color"]),o("div",{class:B(["text-caption",a.getMetaTitleColor()+"--text"])},c((i.form.meta_title||"").length)+"/60 characters ",3)]),_:1}),l(f,{cols:"12"},{default:s(()=>[l(S,{modelValue:i.form.meta_description,"onUpdate:modelValue":e[12]||(e[12]=n=>i.form.meta_description=n),label:"Meta Description",variant:"outlined",rows:"4",hint:"SEO description for search results (recommended: 150-160 characters)","persistent-hint":"",counter:160,color:a.getMetaDescriptionColor(),"prepend-inner-icon":"mdi-text"},{append:s(()=>[l(_,{icon:"mdi-refresh",size:"small",variant:"text",onClick:a.generateMetaDescription,disabled:!i.form.excerpt,title:"Auto-generate from excerpt"},null,8,["onClick","disabled"])]),_:1},8,["modelValue","color"]),o("div",{class:B(["text-caption",a.getMetaDescriptionColor()+"--text"])},c((i.form.meta_description||"").length)+"/160 characters ",3)]),_:1}),l(f,{cols:"12"},{default:s(()=>[l(P,{modelValue:i.form.meta_keywords,"onUpdate:modelValue":e[13]||(e[13]=n=>i.form.meta_keywords=n),label:"Meta Keywords",variant:"outlined",hint:"Comma-separated keywords for SEO","persistent-hint":"","prepend-inner-icon":"mdi-tag-multiple"},null,8,["modelValue"])]),_:1}),l(f,{cols:"12"},{default:s(()=>[l(L,{class:"my-4"}),e[31]||(e[31]=o("h3",{class:"text-h6 font-weight-bold mb-4"},"Open Graph (Social Media)",-1))]),_:1,__:[31]}),l(f,{cols:"12"},{default:s(()=>[l(F,{class:"mb-2"},{default:s(()=>e[32]||(e[32]=[p("Open Graph Image")])),_:1,__:[32]}),l(k,{variant:"outlined",class:"pa-4"},{default:s(()=>[o("div",ve,[i.ogImagePreview||i.form.og_image?(g(),h("div",_e,[l(T,{src:i.ogImagePreview||a.resolveImageUrl(i.form.og_image),"max-width":"300","max-height":"300",class:"rounded elevation-2",cover:""},null,8,["src"]),o("div",be,[l(_,{color:"error",size:"small",variant:"text",onClick:a.removeOgImage,"prepend-icon":"mdi-delete"},{default:s(()=>e[33]||(e[33]=[p(" Remove Image ")])),_:1,__:[33]},8,["onClick"])])])):v("",!0),o("div",ye,[l(U,{modelValue:i.ogImageFile,"onUpdate:modelValue":[e[14]||(e[14]=n=>i.ogImageFile=n),a.handleOgImageSelect],accept:"image/*",label:"Select Open Graph Image",variant:"outlined","prepend-icon":"","prepend-inner-icon":"mdi-image","show-size":"",clearable:"",hint:"Recommended size: 1200x630px. Max file size: 5MB","persistent-hint":""},{append:s(()=>[i.uploadingOgImage?(g(),w(I,{key:0,indeterminate:"",color:"primary",size:"24"})):v("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"]),i.ogImageFile&&i.ogImageFile.size>5242880?(g(),w(d,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mt-2"},{default:s(()=>e[34]||(e[34]=[p(" File size is larger than 5MB. Please choose a smaller image. ")])),_:1,__:[34]})):v("",!0),i.ogImageError?(g(),w(d,{key:1,type:"error",variant:"tonal",density:"compact",class:"mt-2",closable:"","onClick:close":e[15]||(e[15]=n=>i.ogImageError=null)},{default:s(()=>[o("div",we,[e[35]||(e[35]=o("strong",null,"Upload Error:",-1)),p(" "+c(i.ogImageError),1)])]),_:1})):v("",!0)])])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1},512))]),_:1}),l(W,{class:"pa-4 bg-grey-lighten-4"},{default:s(()=>[l(j),l(_,{variant:"text",onClick:a.closeDialog,disabled:i.saving},{default:s(()=>e[36]||(e[36]=[p("Cancel")])),_:1,__:[36]},8,["onClick","disabled"]),l(_,{color:"primary",variant:"flat",onClick:a.savePost,loading:i.saving},{default:s(()=>[p(c(u.editingPost?"Update":"Create")+" Post ",1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const Ie=M(le,[["render",Pe],["__scopeId","data-v-2e8426f2"]]),xe={components:{BlogFormDialog:Ie},mixins:[q],data(){return{posts:[],showDialog:!1,editingPost:null,publishedFilter:null,publishedOptions:[{title:"Published",value:!0},{title:"Draft",value:!1}]}},async mounted(){await this.loadPosts()},methods:{async loadPosts(){try{this.loading=!0;const t=this.buildPaginationParams();this.search&&(t.search=this.search),this.publishedFilter!==null&&(t.published=this.publishedFilter);const e=await y.get("/api/v1/blog-posts",{params:t,headers:this.getAuthHeaders()});this.posts=e.data.data||[],this.updatePagination(e.data)}catch(t){this.handleApiError(t,"Failed to load blog posts")}finally{this.loading=!1}},openDialog(t=null){this.editingPost=t,this.showDialog=!0},editPost(t){this.openDialog(t)},viewPost(t){this.openDialog(t)},handlePostSaved(){this.loadPosts()},async deletePost(t){if(confirm("Are you sure you want to delete this blog post?"))try{await y.delete(`/api/v1/blog-posts/${t}`,{headers:this.getAuthHeaders()}),this.showSuccess("Blog post deleted successfully"),await this.loadPosts()}catch(e){this.handleApiError(e,"Error deleting blog post")}},onPerPageChange(){this.resetPagination(),this.loadPosts()},onSort(t){this.handleSort(t),this.loadPosts()},formatDate(t){if(!t)return"";const e=new Date(t);return e.toLocaleDateString()+" "+e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}}},Ee={class:"page-header"},Ve={class:"text-caption text-grey"},ke={key:0},Fe={class:"d-flex align-center"},Ce={class:"d-flex align-center"},Se={class:"d-flex align-center"},Te={class:"d-flex align-center"},Ue={class:"d-flex"},ze={class:"d-flex align-center"},De={class:"font-weight-medium"},Ae={class:"text-caption text-grey"},Me={key:0},Be={key:1,class:"text-grey"},Oe={key:0},qe={key:1,class:"text-grey"},He={key:0},Re={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},Le={class:"text-caption text-grey"},Ne={key:0},Ge={key:0,class:"ml-2"},Qe={key:1},je={key:0,class:"d-flex align-center gap-2"};function We(t,e,u,m,i,a){const _=r("v-btn"),C=r("v-select"),I=r("v-col"),x=r("v-text-field"),z=r("v-row"),P=r("v-card-text"),f=r("v-card"),S=r("v-card-title"),E=r("v-icon"),b=r("v-skeleton-loader"),V=r("v-img"),F=r("v-chip"),D=r("v-table"),T=r("v-pagination"),U=r("BlogFormDialog");return g(),h("div",null,[o("div",Ee,[e[11]||(e[11]=o("h1",{class:"text-h4 page-title"},"Blog Management",-1)),l(_,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=d=>a.openDialog()),class:"add-button"},{default:s(()=>e[10]||(e[10]=[p("Create Post")])),_:1,__:[10]})]),l(f,{class:"mb-4"},{default:s(()=>[l(P,null,{default:s(()=>[l(z,null,{default:s(()=>[l(I,{cols:"12",md:"4"},{default:s(()=>[l(C,{modelValue:t.perPage,"onUpdate:modelValue":[e[1]||(e[1]=d=>t.perPage=d),a.onPerPageChange],items:t.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(I,{cols:"12",md:"4"},{default:s(()=>[l(C,{modelValue:i.publishedFilter,"onUpdate:modelValue":[e[2]||(e[2]=d=>i.publishedFilter=d),a.loadPosts],items:i.publishedOptions,label:"Filter by Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(I,{cols:"12",md:"4"},{default:s(()=>[l(x,{modelValue:t.search,"onUpdate:modelValue":[e[3]||(e[3]=d=>t.search=d),a.loadPosts],label:"Search posts","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(f,null,{default:s(()=>[l(S,{class:"d-flex justify-space-between align-center"},{default:s(()=>[e[13]||(e[13]=o("span",null,"Blog Posts",-1)),o("span",Ve,[e[12]||(e[12]=p(" Total Records: ")),o("strong",null,c(t.pagination.total||0),1),i.posts.length>0?(g(),h("span",ke," | Showing "+c((t.currentPage-1)*t.perPage+1)+" to "+c(Math.min(t.currentPage*t.perPage,t.pagination.total))+" of "+c(t.pagination.total),1)):v("",!0)])]),_:1,__:[13]}),l(P,null,{default:s(()=>[l(D,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:e[4]||(e[4]=d=>a.onSort("title"))},[o("div",Fe,[e[14]||(e[14]=p(" Title ")),l(E,{icon:t.getSortIcon("title"),size:"small",class:"ml-1"},null,8,["icon"])])]),o("th",{class:"sortable",onClick:e[5]||(e[5]=d=>a.onSort("published_at"))},[o("div",Ce,[e[15]||(e[15]=p(" Published Date ")),l(E,{icon:t.getSortIcon("published_at"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[18]||(e[18]=o("th",null,"Author",-1)),o("th",{class:"sortable",onClick:e[6]||(e[6]=d=>a.onSort("published"))},[o("div",Se,[e[16]||(e[16]=p(" Status ")),l(E,{icon:t.getSortIcon("published"),size:"small",class:"ml-1"},null,8,["icon"])])]),o("th",{class:"sortable",onClick:e[7]||(e[7]=d=>a.onSort("views"))},[o("div",Te,[e[17]||(e[17]=p(" Views ")),l(E,{icon:t.getSortIcon("views"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[19]||(e[19]=o("th",null,"Actions",-1))])]),o("tbody",null,[t.loading?(g(),h(A,{key:0},O(5,d=>o("tr",{key:`skeleton-${d}`},[o("td",null,[l(b,{type:"text",width:"200"})]),o("td",null,[l(b,{type:"text",width:"120"})]),o("td",null,[l(b,{type:"text",width:"100"})]),o("td",null,[l(b,{type:"chip",width:"80",height:"24"})]),o("td",null,[l(b,{type:"text",width:"60"})]),o("td",null,[o("div",Ue,[l(b,{type:"button",width:"32",height:"32",class:"mr-1"}),l(b,{type:"button",width:"32",height:"32",class:"mr-1"}),l(b,{type:"button",width:"32",height:"32"})])])])),64)):(g(),h(A,{key:1},[(g(!0),h(A,null,O(i.posts,d=>(g(),h("tr",{key:d.id},[o("td",null,[o("div",ze,[d.featured_image?(g(),w(V,{key:0,src:d.featured_image,width:"50",height:"50",class:"mr-3 rounded",cover:""},null,8,["src"])):v("",!0),o("div",null,[o("div",De,c(d.title),1),o("div",Ae,c(d.slug),1)])])]),o("td",null,[d.published_at?(g(),h("div",Me,c(a.formatDate(d.published_at)),1)):(g(),h("span",Be,"Not published"))]),o("td",null,[d.author?(g(),h("div",Oe,c(d.author.name||d.author.email),1)):(g(),h("span",qe,"Unknown"))]),o("td",null,[l(F,{color:d.published?"success":"error",size:"small"},{default:s(()=>[p(c(d.published?"Published":"Draft"),1)]),_:2},1032,["color"])]),o("td",null,c(d.views||0),1),o("td",null,[l(_,{size:"small",icon:"mdi-eye",onClick:k=>a.viewPost(d),variant:"text",color:"info",title:"View Post"},null,8,["onClick"]),l(_,{size:"small",icon:"mdi-pencil",onClick:k=>a.editPost(d),variant:"text",title:"Edit Post"},null,8,["onClick"]),l(_,{size:"small",icon:"mdi-delete",onClick:k=>a.deletePost(d.id),variant:"text",color:"error",title:"Delete Post"},null,8,["onClick"])])]))),128)),i.posts.length===0?(g(),h("tr",He,e[20]||(e[20]=[o("td",{colspan:"6",class:"text-center py-4"},"No blog posts found",-1)]))):v("",!0)],64))])]),_:1}),o("div",Re,[o("div",Le,[i.posts.length>0&&t.pagination.total>0?(g(),h("span",Ne,[e[21]||(e[21]=p(" Showing ")),o("strong",null,c((t.currentPage-1)*t.perPage+1),1),e[22]||(e[22]=p(" to ")),o("strong",null,c(Math.min(t.currentPage*t.perPage,t.pagination.total)),1),e[23]||(e[23]=p(" of ")),o("strong",null,c(t.pagination.total.toLocaleString()),1),e[24]||(e[24]=p(" records ")),t.pagination.last_page>1?(g(),h("span",Ge," (Page "+c(t.currentPage)+" of "+c(t.pagination.last_page)+") ",1)):v("",!0)])):(g(),h("span",Qe," No records found "))]),t.pagination.last_page>1?(g(),h("div",je,[l(T,{modelValue:t.currentPage,"onUpdate:modelValue":[e[8]||(e[8]=d=>t.currentPage=d),a.loadPosts],length:t.pagination.last_page,"total-visible":7,density:"comfortable"},null,8,["modelValue","length","onUpdate:modelValue"])])):v("",!0)])]),_:1})]),_:1}),l(U,{modelValue:i.showDialog,"onUpdate:modelValue":e[9]||(e[9]=d=>i.showDialog=d),"editing-post":i.editingPost,onSaved:a.handlePostSaved},null,8,["modelValue","editing-post","onSaved"])])}const Ze=M(xe,[["render",We],["__scopeId","data-v-ea264eb0"]]);export{Ze as default};
